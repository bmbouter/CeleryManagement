

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Policies API &mdash; CeleryManagement v0.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CeleryManagement v0.0 documentation" href="../index.html" />
    <link rel="up" title="Policies" href="index.html" />
    <link rel="next" title="Policy Recipes" href="recipes.html" />
    <link rel="prev" title="Policies Overview" href="overview.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="recipes.html" title="Policy Recipes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Policies Overview"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">CeleryManagement v0.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Policies</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="policies-api">
<span id="id1"></span><h1><a class="toc-backref" href="#id12">Policies API</a><a class="headerlink" href="#policies-api" title="Permalink to this headline">¶</a></h1>
<p>Policies consist of three sections: schedule, condition, and apply.  The API
varies depending on the section it is in.  The first section, <cite>schedule</cite>,
provides the most restrictive API since its only purpose is to return a
schedule object.  The <cite>condition</cite> section is also somewhat restricted, and the
<cite>apply</cite> section has the most feature-filled API.</p>
<p>See <a class="reference internal" href="overview.html#policies-overview"><em>Policies Overview</em></a> for information about how
policies may be used.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#policies-api" id="id12">Policies API</a><ul>
<li><a class="reference internal" href="#task-and-worker-settings" id="id13">Task and Worker Settings</a><ul>
<li><a class="reference internal" href="#collections" id="id14">Collections</a></li>
<li><a class="reference internal" href="#tasks-collection" id="id15">Tasks Collection</a></li>
<li><a class="reference internal" href="#workers-collection" id="id16">Workers Collection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#task-and-worker-stats" id="id17">Task and Worker Stats</a></li>
<li><a class="reference internal" href="#policy-schedule" id="id18">Policy Schedule</a></li>
<li><a class="reference internal" href="#common-api" id="id19">Common API</a><ul>
<li><a class="reference internal" href="#utilities" id="id20">Utilities</a><ul>
<li><a class="reference internal" href="#email" id="id21">Email</a></li>
<li><a class="reference internal" href="#celery-states" id="id22">Celery States</a></li>
</ul>
</li>
<li><a class="reference internal" href="#available-standard-modules" id="id23">Available Standard Modules</a></li>
<li><a class="reference internal" href="#python-builtins" id="id24">Python Builtins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id25">Examples</a></li>
<li><a class="reference internal" href="#availability-by-policy-section" id="id26">Availability by Policy Section</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="task-and-worker-settings">
<h2><a class="toc-backref" href="#id13">Task and Worker Settings</a><a class="headerlink" href="#task-and-worker-settings" title="Permalink to this headline">¶</a></h2>
<p>This sections discusses how to check <a class="reference internal" href="#tasks-collection"><em>tasks&#8217;</em></a> and
<a class="reference internal" href="#workers-collection"><em>workers&#8217;</em></a> settings as well as how to modify those
settings.  A similar API, called a collection, is followed for both.</p>
<div class="section" id="collections">
<h3><a class="toc-backref" href="#id14">Collections</a><a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<p>The pattern that is followed for accessing both tasks and workers settings is
called a collection.  Using this interface, one may access one, many, or all
tasks or workers.</p>
<p>In the policy API, the collections are referred to by the names <tt class="docutils literal"><span class="pre">tasks</span></tt> for
tasks, and <tt class="docutils literal"><span class="pre">workers</span></tt> for workers.  Please see their specific topics below for
the details of accessing tasks and workers.</p>
<p>Here is the general pattern for accessing specific collection members:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">collection</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>                    <span class="c"># access all collection members</span>
<span class="n">collection</span><span class="p">[</span><span class="s">&#39;NAME&#39;</span><span class="p">]</span>                  <span class="c"># access a specific collection member</span>
<span class="n">collection</span><span class="p">[(</span><span class="s">&#39;NAME1&#39;</span><span class="p">,</span><span class="s">&#39;NAME2&#39;</span><span class="p">,</span><span class="o">...</span><span class="p">)]</span>   <span class="c"># access multiple collection members</span>
</pre></div>
</div>
<p>The first example above accesses all members of the collection.  The object
returned can be used to set the same setting on all of those members.  The
second example accesses only the single named object.  The returned value can
be used to get or set the settings on that specific object.  The third example
accesses multiple specificly-named objects.  The returned value can be used to
set the same setting on those specifically-named objects.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Collections API is designed to be simple and intuitive.
One manifestiation of this is that they always return single values.
Because the same setting may have different values on different objects, it
makes no sense to get a single setting from multiple objects.  As a result,
settings may be retrieved for only one named object at a time.</p>
<p>For example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">val</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">ignore_result</span>             <span class="c"># This will raise an exception.</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="s">&#39;tasks.MyTask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ignore_result</span>   <span class="c"># This is OK.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tasks-collection">
<span id="id2"></span><h3><a class="toc-backref" href="#id15">Tasks Collection</a><a class="headerlink" href="#tasks-collection" title="Permalink to this headline">¶</a></h3>
<dl class="data">
<dt id="tasks">
<tt class="descname">tasks</tt><a class="headerlink" href="#tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>The tasks collection available to policies.  This allows one to inspect and
modify selected Celery <a class="reference external" href="http://ask.github.com/celery/userguide/tasks.html#guide-tasks" title="(in Celery v2.2)"><em class="xref std std-ref">Task</em></a> attributes.  The methods
on this object return instances of <a class="reference internal" href="#TaskItem" title="TaskItem"><tt class="xref py py-class docutils literal"><span class="pre">TaskItem</span></tt></a>.</p>
</dd></dl>

<dl class="class">
<dt id="TaskItem">
<em class="property">class </em><tt class="descname">TaskItem</tt><a class="headerlink" href="#TaskItem" title="Permalink to this definition">¶</a></dt>
<dd><p>An object which represents one or more Celery Task types.  Such an object
may be retrieved via the <a class="reference internal" href="#tasks" title="tasks"><tt class="xref py py-data docutils literal"><span class="pre">tasks</span></tt></a> object within a Policy.</p>
<p>To retrieve the routing_key on a Task named tasks.MyTask:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="s">&#39;tasks.MyTask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">routing_key</span>
</pre></div>
</div>
<p>To set the ignore_result attribute on the same Task:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tasks</span><span class="p">[</span><span class="s">&#39;tasks.MyTask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ignore_result</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>The following Task attributes are available:</p>
<dl class="attribute">
<dt id="TaskItem.ignore_result">
<tt class="descname">ignore_result</tt><a class="headerlink" href="#TaskItem.ignore_result" title="Permalink to this definition">¶</a></dt>
<dd><p>bool</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.routing_key">
<tt class="descname">routing_key</tt><a class="headerlink" href="#TaskItem.routing_key" title="Permalink to this definition">¶</a></dt>
<dd><p>str or None</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.exchange">
<tt class="descname">exchange</tt><a class="headerlink" href="#TaskItem.exchange" title="Permalink to this definition">¶</a></dt>
<dd><p>str or None</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.default_retry_delay">
<tt class="descname">default_retry_delay</tt><a class="headerlink" href="#TaskItem.default_retry_delay" title="Permalink to this definition">¶</a></dt>
<dd><p>int</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.rate_limit">
<tt class="descname">rate_limit</tt><a class="headerlink" href="#TaskItem.rate_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>str or None</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.store_errors_even_if_ignored">
<tt class="descname">store_errors_even_if_ignored</tt><a class="headerlink" href="#TaskItem.store_errors_even_if_ignored" title="Permalink to this definition">¶</a></dt>
<dd><p>bool</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.acks_late">
<tt class="descname">acks_late</tt><a class="headerlink" href="#TaskItem.acks_late" title="Permalink to this definition">¶</a></dt>
<dd><p>bool</p>
</dd></dl>

<dl class="attribute">
<dt id="TaskItem.expires">
<tt class="descname">expires</tt><a class="headerlink" href="#TaskItem.expires" title="Permalink to this definition">¶</a></dt>
<dd><p>int or None</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="workers-collection">
<span id="id3"></span><h3><a class="toc-backref" href="#id16">Workers Collection</a><a class="headerlink" href="#workers-collection" title="Permalink to this headline">¶</a></h3>
<dl class="data">
<dt id="workers">
<tt class="descname">workers</tt><a class="headerlink" href="#workers" title="Permalink to this definition">¶</a></dt>
<dd><p>The workers collection available to policies.  This allows one to inspect
and modify selected attributes of running Celery
<a class="reference external" href="http://ask.github.com/celery/userguide/workers.html#guide-worker" title="(in Celery v2.2)"><em class="xref std std-ref">Workers</em></a>.  The methods on this object return instances
of <a class="reference internal" href="#WorkerItem" title="WorkerItem"><tt class="xref py py-class docutils literal"><span class="pre">WorkerItem</span></tt></a>.</p>
</dd></dl>

<dl class="class">
<dt id="WorkerItem">
<em class="property">class </em><tt class="descname">WorkerItem</tt><a class="headerlink" href="#WorkerItem" title="Permalink to this definition">¶</a></dt>
<dd><p>An object which represents one or more running Celery Workers.  Such an
object may be retrieved via the <a class="reference internal" href="#workers" title="workers"><tt class="xref py py-data docutils literal"><span class="pre">workers</span></tt></a> object within a Policy.</p>
<p>To get the prefetch value for a Worker named myworker.example.org:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">workers</span><span class="p">[</span><span class="s">&quot;myworker.example.org&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">prefetch</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
<p>To increment the number of subprocesses on the same worker:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">workers</span><span class="p">[</span><span class="s">&quot;myworker.example.org&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">subprocesses</span><span class="o">.</span><span class="n">increment</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="WorkerItem.prefetch">
<tt class="descname">prefetch</tt><a class="headerlink" href="#WorkerItem.prefetch" title="Permalink to this definition">¶</a></dt>
<dd><p>The object returned has the following methods:</p>
<dl class="method">
<dt id="WorkerItem.increment">
<tt class="descname">increment</tt><big>(</big><span class="optional">[</span><em>n</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#WorkerItem.increment" title="Permalink to this definition">¶</a></dt>
<dt id="WorkerItem.decrement">
<tt class="descname">decrement</tt><big>(</big><span class="optional">[</span><em>n</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#WorkerItem.decrement" title="Permalink to this definition">¶</a></dt>
<dd><p>If not given, the <cite>n</cite> argument defaults to 1.</p>
</dd></dl>

<dl class="method">
<dt id="WorkerItem.get">
<tt class="descname">get</tt><big>(</big><big>)</big><a class="headerlink" href="#WorkerItem.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the worker&#8217;s current prefetch value.</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="WorkerItem.subprocesses">
<tt class="descname">subprocesses</tt><a class="headerlink" href="#WorkerItem.subprocesses" title="Permalink to this definition">¶</a></dt>
<dd><p>The object returned has the following methods:</p>
<dl class="method">
<dt>
<tt class="descname">increment</tt><big>(</big><span class="optional">[</span><em>n</em><span class="optional">]</span><big>)</big></dt>
<dt>
<tt class="descname">decrement</tt><big>(</big><span class="optional">[</span><em>n</em><span class="optional">]</span><big>)</big></dt>
<dd><p>If not given, the <cite>n</cite> argument defaults to 1.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">get</tt><big>(</big><big>)</big></dt>
<dd><p>Return the number of subprocesses the worker has.</p>
</dd></dl>

</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="task-and-worker-stats">
<h2><a class="toc-backref" href="#id17">Task and Worker Stats</a><a class="headerlink" href="#task-and-worker-stats" title="Permalink to this headline">¶</a></h2>
<dl class="data">
<dt id="stats">
<tt class="descname">stats</tt><a class="headerlink" href="#stats" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>stats</cite> object provides several methods to inspect the current status
and past performance of tasks.  The following are the available methods:</p>
<dl class="method">
<dt>
<tt class="descname">tasks</tt><big>(</big><em>states=None</em>, <em>interval=None</em>, <em>workers=None</em>, <em>tasknames=None</em><big>)</big></dt>
<dd><p>The number of tasks that meet the given conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>states</strong> &#8211; A single Celery state constant or an iterable of such
constants.</li>
<li><strong>interval</strong> &#8211; <p>A single datetime.timedelta object, or a pair of
datetime.timedelta and/or datetime.datetime objects (as a tuple).
When it is a single timedelta object, the interval spans the time
from timedelta seconds <a class="footnote-reference" href="#id9" id="id4">[1]</a> before now up to now.  When it is a
pair, the interpretation depends on the element types:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">(timedelta</span> <span class="pre">i,</span> <span class="pre">datetime</span> <span class="pre">j)</span></tt>:</dt>
<dd>The time between time <cite>j</cite> and <cite>i</cite> seconds <a class="footnote-reference" href="#id9" id="id5">[1]</a> before time <cite>j</cite>.</dd>
<dt><tt class="docutils literal"><span class="pre">(datetime</span> <span class="pre">i,</span> <span class="pre">timedelta</span> <span class="pre">j)</span></tt>:</dt>
<dd>The time between time <cite>i</cite> and <cite>j</cite> seconds <a class="footnote-reference" href="#id9" id="id6">[1]</a> after time <cite>i</cite>.</dd>
<dt><tt class="docutils literal"><span class="pre">(timedelta</span> <span class="pre">i,</span> <span class="pre">timedelta</span> <span class="pre">j)</span></tt>:</dt>
<dd>The time between <cite>i</cite> seconds <a class="footnote-reference" href="#id9" id="id7">[1]</a> before now and <cite>j</cite> seconds <a class="footnote-reference" href="#id9" id="id8">[1]</a>
before now.</dd>
<dt><tt class="docutils literal"><span class="pre">(datetime</span> <span class="pre">i,</span> <span class="pre">datetime</span> <span class="pre">j)</span></tt>:</dt>
<dd>The time between time <cite>i</cite> and time <cite>j</cite>.</dd>
</dl>
<p>In all cases, the calculated date pairs are adjusted so the left
datetime is less than the right.</p>
</li>
<li><strong>workers</strong> &#8211; The worker or workers to which to limit the search.
This can be a worker name as a string, an iterable of
worker names, or None in which case all workers are
queried.</li>
<li><strong>tasknames</strong> &#8211; The task or tasks to which to limit the search.  This
can be a task name as a string, an iterable of task
names, or None in which case all tasks are queried.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tasks_failed">
<tt class="descname">tasks_failed</tt><big>(</big><em>interval=None</em>, <em>workers=None</em>, <em>tasknames=None</em><big>)</big><a class="headerlink" href="#tasks_failed" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks that meet the given conditions and that have
failed.  The parameters <cite>interval</cite>, <cite>workers</cite>, and <cite>tasknames</cite> have the
same meaning as in <a class="reference internal" href="#tasks" title="tasks"><tt class="xref py py-meth docutils literal"><span class="pre">tasks()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tasks_succeeded">
<tt class="descname">tasks_succeeded</tt><big>(</big><em>interval=None</em>, <em>workers=None</em>, <em>tasknames=None</em><big>)</big><a class="headerlink" href="#tasks_succeeded" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks that meet the given conditions and that have
succeeded.  The parameters <cite>interval</cite>, <cite>workers</cite>, and <cite>tasknames</cite> have
the same meaning as in <a class="reference internal" href="#tasks" title="tasks"><tt class="xref py py-meth docutils literal"><span class="pre">tasks()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tasks_revoked">
<tt class="descname">tasks_revoked</tt><big>(</big><em>interval=None</em>, <em>workers=None</em>, <em>tasknames=None</em><big>)</big><a class="headerlink" href="#tasks_revoked" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks that meet the given conditions and that have been
revoked.  The parameters <cite>interval</cite>, <cite>workers</cite>, and <cite>tasknames</cite> have
the same meaning as in <a class="reference internal" href="#tasks" title="tasks"><tt class="xref py py-meth docutils literal"><span class="pre">tasks()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tasks_ready">
<tt class="descname">tasks_ready</tt><big>(</big><em>interval=None</em>, <em>workers=None</em>, <em>tasknames=None</em><big>)</big><a class="headerlink" href="#tasks_ready" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks that meet the given conditions and that are in a
ready state.  The parameters <cite>interval</cite>, <cite>workers</cite>, and <cite>tasknames</cite>
have the same meaning as in <a class="reference internal" href="#tasks" title="tasks"><tt class="xref py py-meth docutils literal"><span class="pre">tasks()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tasks_sent">
<tt class="descname">tasks_sent</tt><big>(</big><em>interval=None</em>, <em>workers=None</em>, <em>tasknames=None</em><big>)</big><a class="headerlink" href="#tasks_sent" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks that meet the given conditions and that are in an
unready state.  The parameters <cite>interval</cite>, <cite>workers</cite>, and <cite>tasknames</cite>
have the same meaning as in <a class="reference internal" href="#tasks" title="tasks"><tt class="xref py py-meth docutils literal"><span class="pre">tasks()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="mean_waittime">
<tt class="descname">mean_waittime</tt><big>(</big><em>states</em>, <em>interval</em>, <em>workers</em>, <em>tasknames</em><big>)</big><a class="headerlink" href="#mean_waittime" title="Permalink to this definition">¶</a></dt>
<dd><p>The average wait time of the tasks that meet the given conditions.</p>
</dd></dl>

<dl class="method">
<dt id="mean_runtime">
<tt class="descname">mean_runtime</tt><big>(</big><em>states</em>, <em>interval</em>, <em>workers</em>, <em>tasknames</em><big>)</big><a class="headerlink" href="#mean_runtime" title="Permalink to this definition">¶</a></dt>
<dd><p>The average run time of the tasks that meet the given conditions.</p>
</dd></dl>

</dd></dl>

<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id5">2</a>, <a class="fn-backref" href="#id6">3</a>, <a class="fn-backref" href="#id7">4</a>, <a class="fn-backref" href="#id8">5</a>)</em> <tt class="docutils literal"><span class="pre">timedelta</span></tt> is not restricted to seconds, but using some concrete unit
of time here is clearer.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="policy-schedule">
<span id="id10"></span><h2><a class="toc-backref" href="#id18">Policy Schedule</a><a class="headerlink" href="#policy-schedule" title="Permalink to this headline">¶</a></h2>
<p>The schedule section provides functions that (strangely enough) can create
schedules.  The evaluation of the section must result in a schedule object.</p>
<dl class="function">
<dt id="crontab">
<tt class="descname">crontab</tt><big>(</big><em>minute</em>, <em>hour</em>, <em>day_of_week</em><big>)</big><a class="headerlink" href="#crontab" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates a schedule that allows cron-like scheduling.  The
class itself is provided by Celery, so please see the <a class="reference external" href="http://ask.github.com/celery/userguide/periodic-tasks.html#crontab-schedules">documentation
there</a> for more infomation.</p>
<p>Examples (reproduced here from the Celery documentation):</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">crontab()</span></tt></dt>
<dd>Execute every minute.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=0,</span> <span class="pre">hour=0)</span></tt></dt>
<dd>Execute daily at midnight.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=0,</span> <span class="pre">hour=&quot;*/3&quot;)</span></tt></dt>
<dd>Execute every three hours: 3am, 6am, 9am, noon, 3pm, 6pm, 9pm.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=0,</span> <span class="pre">hour=[0,3,6,9,12,15,18,21])</span></tt></dt>
<dd>Same as previous.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=&quot;*/15&quot;)</span></tt></dt>
<dd>Execute every 15 minutes.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(day_of_week=&quot;sunday&quot;)</span></tt></dt>
<dd>Execute every minute (!) at Sundays.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=&quot;*&quot;,</span> <span class="pre">hour=&quot;*&quot;,</span> <span class="pre">day_of_week=&quot;sun&quot;)</span></tt></dt>
<dd>Same as previous.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=&quot;*/10&quot;,</span> <span class="pre">hour=&quot;3,17,22&quot;,</span> <span class="pre">day_of_week=&quot;thu,fri&quot;)</span></tt></dt>
<dd>Execute every ten minutes, but only between 3-4 am, 5-6 pm and
10-11 pm on Thursdays or Fridays.</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=0,</span> <span class="pre">hour=&quot;*/2,*/3&quot;)</span></tt></dt>
<dd>Execute every even hour, and every hour divisible by three. This
means: at every hour <cite>except</cite>: 1am, 5am, 7am, 11am, 1pm, 5pm, 7pm, 11pm</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=0,</span> <span class="pre">hour=&quot;*/5&quot;)</span></tt></dt>
<dd>Execute hour divisible by 5. This means that it is triggered at 3pm,
not 5pm (since 3pm equals the 24-hour clock value of “15”, which is
divisible by 5).</dd>
<dt><tt class="docutils literal"><span class="pre">crontab(minute=0,</span> <span class="pre">hour=&quot;*/3,8-17&quot;)</span></tt></dt>
<dd>Execute every hour divisible by 3, and every hour during office
hours (8am-5pm).</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="common-api">
<h2><a class="toc-backref" href="#id19">Common API</a><a class="headerlink" href="#common-api" title="Permalink to this headline">¶</a></h2>
<p>Although using a subset of Python, policies still provide many of the
language&#8217;s built-in functions, constants and a few selected modules.</p>
<div class="section" id="utilities">
<h3><a class="toc-backref" href="#id20">Utilities</a><a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="now">
<tt class="descname">now</tt><big>(</big><big>)</big><a class="headerlink" href="#now" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current time as a <a class="reference external" href="http://docs.python.org/2.7/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></tt></a> object.  (The
datetime module is also available to policies.)</p>
</dd></dl>

<dl class="function">
<dt id="today">
<tt class="descname">today</tt><big>(</big><span class="optional">[</span><em>offset_days</em>, <em>timestr</em>, <em>time</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#today" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current date as a <a class="reference external" href="http://docs.python.org/2.7/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></tt></a> object.  (The
datetime module is also available to policies.)  All arguments are
optional, and only keyword arguments are allowed.</p>
<p>If no arguments are provided, the time defaults to <tt class="docutils literal"><span class="pre">00:00:00</span></tt> (midnight).
However, some keyword arguments are offered which can change this behavior.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>offset_days</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; An integer which can set the date forward or
backward from the current date.</li>
<li><strong>timestr</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; <p>A string representing a time which will be used in
the returned datetime object.  The string&#8217;s format is
as follows: <tt class="docutils literal"><span class="pre">HH:MM:SS.mmmmmm</span></tt></p>
<ul>
<li><tt class="docutils literal"><span class="pre">HH</span></tt>, <tt class="docutils literal"><span class="pre">MM</span></tt>, <tt class="docutils literal"><span class="pre">SS</span></tt> are the minutes, hours, and
seconds.</li>
<li><tt class="docutils literal"><span class="pre">mmmmmm</span></tt> is the microseconds, which can be 0-6
digits.</li>
</ul>
<p>The seconds and microseconds are optional.</p>
</li>
<li><strong>time</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; A tuple representing a time which will be used in the
returned datetime object.  The elements much be
integers which represent: hours, minutes, seconds, and
microseconds.  The seconds and microseconds are
optional.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If both <em>timestr</em> and <em>time</em> are provided, only <em>timestr</em> will be used.</p>
</dd></dl>

<div class="section" id="email">
<h4><a class="toc-backref" href="#id21">Email</a><a class="headerlink" href="#email" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="send_email">
<tt class="descname">send_email</tt><big>(</big><em>subject</em>, <em>message</em>, <em>from_email</em>, <em>recipient_list</em><span class="optional">[</span>, <em>auth_user</em><span class="optional">[</span>, <em>auth_password</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#send_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Sometimes, a policy does not need to (or is not able to) respond
automatically to the condition it finds.  This function allows a policy to
send you an email in such situations.  It is built on top of <a class="reference external" href="http://www.djangoproject.com/">Django</a>&#8216;s
email feature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>subject</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The subject of the email message, as a string.</li>
<li><strong>message</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The content of the email message, as a string.</li>
<li><strong>from_email</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The email address that will appear in the <em>from</em> field.</li>
<li><strong>recipient_list</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; A list of email addresses to which to send the email.</li>
<li><strong>auth_user</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Username for the SMTP server.  If not given,
Django will use the <tt class="docutils literal"><span class="pre">EMAIL_HOST_USER</span></tt> setting.</li>
<li><strong>auth_password</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Password for the SMTP server.  If not given,
Django will use the <tt class="docutils literal"><span class="pre">EMAIL_HOST_PASSWORD</span></tt>
setting.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="celery-states">
<h4><a class="toc-backref" href="#id22">Celery States</a><a class="headerlink" href="#celery-states" title="Permalink to this headline">¶</a></h4>
<p>The following <a class="reference external" href="http://ask.github.com/celery/userguide/tasks.html#task-states" title="(in Celery v2.2)"><em class="xref std std-ref">Celery states</em></a> are available as
constants:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PENDING</span><span class="p">,</span> <span class="n">RECEIVED</span><span class="p">,</span> <span class="n">STARTED</span><span class="p">,</span> <span class="n">SUCCESS</span><span class="p">,</span> <span class="n">FAILURE</span><span class="p">,</span> <span class="n">REVOKED</span><span class="p">,</span> <span class="n">RETRY</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="available-standard-modules">
<h3><a class="toc-backref" href="#id23">Available Standard Modules</a><a class="headerlink" href="#available-standard-modules" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/2.7/library/datetime.html#module-datetime" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">datetime</span></tt></a></li>
<li><a class="reference external" href="http://docs.python.org/2.7/library/time.html#module-time" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">time</span></tt></a></li>
<li><a class="reference external" href="http://docs.python.org/2.7/library/calendar.html#module-calendar" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">calendar</span></tt></a></li>
<li><a class="reference external" href="http://docs.python.org/2.7/library/math.html#module-math" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">math</span></tt></a></li>
</ul>
</div>
<div class="section" id="python-builtins">
<h3><a class="toc-backref" href="#id24">Python Builtins</a><a class="headerlink" href="#python-builtins" title="Permalink to this headline">¶</a></h3>
<p>Many of the standard builtin functions are available.  But some, like
<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#eval" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">eval()</span></tt></a> and <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#__import__" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">__import__()</span></tt></a> are not allowed. The following builtin
functions are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="21%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head"></th>
<th class="head"></th>
<th class="head">Built-in Functions</th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody valign="top">
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#abs" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">abs()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">int()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#next" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">next()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#slice" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">slice()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#all" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">all()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#divmod" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">divmod()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#isinstance" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">isinstance()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#oct" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">oct()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#sorted" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">sorted()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#any" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">any()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#enumerate" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">enumerate()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#issubclass" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">issubclass()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#ord" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">ord()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">str()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#basestring" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">basestring()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#filter" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">filter()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#iter" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">iter()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#pow" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">pow()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#sum" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">sum()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#bin" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">bin()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">float()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#len" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">len()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#print" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">print()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">tuple()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">bool()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#format" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">format()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#list" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">list()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#range" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">range()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#unichr" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">unichr()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#bytearray" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">bytearray()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#frozenset" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">frozenset</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#long" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">long()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#reduce" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">reduce()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#unicode" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">unicode()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">callable()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#hash" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">hash()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#map" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">map()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#repr" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">repr()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#xrange" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">xrange()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#chr" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">chr()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#help" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">help()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#max" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">max()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#reversed" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">reversed()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#zip" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">zip()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#cmp" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">cmp()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#hex" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">hex()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#memoryview" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">memoryview</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#round" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">round()</span></tt></a></td>
<td>&nbsp;</td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#complex" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">complex()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#id" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">id()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#min" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">min()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#set" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">set</span></tt></a></td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>The following builtin functions are <em>not</em> available (this list may be
incomplete):</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="35%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head"></th>
<th class="head">Prohibited Functions</th>
<th class="head"></th>
</tr>
</thead>
<tbody valign="top">
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#compile" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">compile()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#globals" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">globals()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#raw_input" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">raw_input()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#eval" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">eval()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#hasattr" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">hasattr()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#reload" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">reload()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#execfile" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">execfile()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#input" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">input()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#setattr" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">setattr()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#file" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">file()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#locals" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">locals()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#type" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">type()</span></tt></a></td>
</tr>
<tr><td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#getattr" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">getattr()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#open" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">open()</span></tt></a></td>
<td><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#__import__" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">__import__()</span></tt></a></td>
</tr>
</tbody>
</table>
<p>The following standard builtin constants are also available:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">None</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id25">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The following examples show how to use various portions of the policies API.
See <a class="reference internal" href="recipes.html#policy-recipes"><em>Policy Recipes</em></a> for examples of entire policies.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">tasks</span><span class="p">()</span>   <span class="c"># 1</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>The number of tasks sent.  (This will not be all tasks ever sent because
old records in the database are cleared periodically.)</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">tasks</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>    <span class="c"># 2</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>The number of tasks sent over the last hour.</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">tasks</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>    <span class="c"># 3</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>The number of tasks sent between one hour and two hours ago.</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">tasks</span><span class="p">(</span><span class="n">tasknames</span><span class="o">=</span><span class="s">&quot;my_task&quot;</span><span class="p">)</span>    <span class="c"># 4</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>The number of tasks of type <tt class="docutils literal"><span class="pre">my_task</span></tt> sent.</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">tasks</span><span class="p">(</span><span class="n">tasknames</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;my_task&quot;</span><span class="p">,</span><span class="s">&quot;your_task&quot;</span><span class="p">])</span>      <span class="c"># 5</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li>The number of tasks of type <tt class="docutils literal"><span class="pre">my_task</span></tt> <cite>or</cite> <tt class="docutils literal"><span class="pre">your_task</span></tt> sent.</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="s">&quot;my_task&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ignore_result</span>      <span class="c"># 6</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li>Get the <tt class="docutils literal"><span class="pre">ignore_result</span></tt> setting for tasks of type <tt class="docutils literal"><span class="pre">my_task</span></tt>.</li>
</ol>
</div>
<div class="section" id="availability-by-policy-section">
<h2><a class="toc-backref" href="#id26">Availability by Policy Section</a><a class="headerlink" href="#availability-by-policy-section" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="28%" />
<col width="28%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head"></th>
<th class="head">schedule</th>
<th class="head">condition</th>
<th class="head">apply</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Common API</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr><td>send_email</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>✓</td>
</tr>
<tr><td>crontab</td>
<td>✓</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>stats</td>
<td>&nbsp;</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr><td>tasks</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>✓</td>
</tr>
<tr><td>workers</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>✓</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Policies API</a><ul>
<li><a class="reference internal" href="#task-and-worker-settings">Task and Worker Settings</a><ul>
<li><a class="reference internal" href="#collections">Collections</a></li>
<li><a class="reference internal" href="#tasks-collection">Tasks Collection</a></li>
<li><a class="reference internal" href="#workers-collection">Workers Collection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#task-and-worker-stats">Task and Worker Stats</a></li>
<li><a class="reference internal" href="#policy-schedule">Policy Schedule</a></li>
<li><a class="reference internal" href="#common-api">Common API</a><ul>
<li><a class="reference internal" href="#utilities">Utilities</a><ul>
<li><a class="reference internal" href="#email">Email</a></li>
<li><a class="reference internal" href="#celery-states">Celery States</a></li>
</ul>
</li>
<li><a class="reference internal" href="#available-standard-modules">Available Standard Modules</a></li>
<li><a class="reference internal" href="#python-builtins">Python Builtins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#availability-by-policy-section">Availability by Policy Section</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="overview.html"
                        title="previous chapter">Policies Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="recipes.html"
                        title="next chapter">Policy Recipes</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/policy/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="recipes.html" title="Policy Recipes"
             >next</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Policies Overview"
             >previous</a> |</li>
        <li><a href="../index.html">CeleryManagement v0.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Policies</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, ITng Services.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>